<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Font Preview — Modern UI</title>
  <style>
    :root{
      --bg:#0f1724; /* dark navy */
      --card:#0b1220;
      --muted:#9aa4b2;
      --accent-1: linear-gradient(135deg,#7c3aed 0%,#06b6d4 100%);
      --glass: rgba(255,255,255,0.04);
      --glass-2: rgba(255,255,255,0.03);
      --radius:14px;
      --ease: 240ms cubic-bezier(.2,.9,.3,1);
      --text:#e6eef6;
      --logo-size:56px;
    }

    /* Light theme overrides */
    body[data-theme='light']{ --bg: #f6f8fb; --card: #ffffff; --muted: #6b7280; --glass: rgba(2,6,23,0.04); --text: #0b1220; }

    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter, ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;color:var(--text);background:radial-gradient(1200px 600px at 10% 10%, rgba(12,18,28,0.06), transparent), radial-gradient(1000px 500px at 90% 90%, rgba(6,11,21,0.05), transparent), var(--bg);transition:background var(--ease), color var(--ease)}

    /* reduced motion */
    @media (prefers-reduced-motion: reduce) {
      :root{ --ease: 50ms linear; }
      *{transition:none!important}
    }

    .app{max-width:1200px;margin:28px auto;padding:24px;display:grid;grid-template-columns:360px 1fr;gap:20px}

    header{grid-column:1/-1;display:flex;align-items:center;gap:14px}
    .logo{width:var(--logo-size);height:var(--logo-size);border-radius:12px;background:var(--accent-1);display:flex;align-items:center;justify-content:center;color:white;font-weight:700;box-shadow:0 8px 30px rgba(12,18,40,0.18);transform-origin:center;animation:logoFloat 6s ease-in-out infinite}
    @keyframes logoFloat{0%{transform:translateY(0)}50%{transform:translateY(-6px) rotate(-2deg)}100%{transform:translateY(0)}}

    h1{font-size:20px;margin:0}
    p.lead{margin:0;color:var(--muted);font-size:13px}

    /* controls */
    .panel{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:var(--radius);padding:18px;box-shadow:0 10px 30px rgba(2,6,23,0.06);border:1px solid rgba(255,255,255,0.03);transition:box-shadow var(--ease), transform var(--ease)}
    body[data-theme='light'] .panel{background:linear-gradient(180deg, rgba(2,6,23,0.01), rgba(2,6,23,0.01));box-shadow:0 8px 20px rgba(2,6,23,0.04);border:1px solid rgba(2,6,23,0.04)}
    .section{margin-bottom:14px}
    label{display:block;font-size:12px;color:var(--muted);margin-bottom:6px}

    /* base input styles */
    select, textarea, input[type='color']{width:100%;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit;outline:none;transition:border-color var(--ease), box-shadow var(--ease)}
    body[data-theme='light'] select, body[data-theme='light'] textarea{border:1px solid rgba(2,6,23,0.06); background:transparent}

    /* Dark-mode only: make selects visibly darker (keeps light mode unchanged) */
    body[data-theme='dark'] select, body[data-theme='dark'] textarea{background: rgba(0,0,0,0.45);border: 1px solid rgba(255,255,255,0.03);}

    textarea{min-height:88px;resize:vertical;padding:12px;font-size:16px}

    .row{display:flex;gap:10px}
    .col{flex:1}

    .range{display:flex;align-items:center;gap:12px}
    .range input[type='range']{flex:1;-webkit-appearance:none;height:6px;background:linear-gradient(90deg,#3b82f6, #7c3aed);border-radius:8px;outline:none}
    .range output{min-width:46px;text-align:right;font-size:13px;color:var(--muted)}

    .toggle{display:inline-flex;align-items:center;gap:8px}
    .btn{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;background:var(--glass);border-radius:10px;border:1px solid rgba(255,255,255,0.03);cursor:pointer;color:var(--muted);transition:all var(--ease);user-select:none}
    .btn:hover{transform:translateY(-4px);box-shadow:0 10px 30px rgba(7,10,20,0.06)}
    .btn.active{background:linear-gradient(90deg,rgba(124,58,237,0.18), rgba(6,182,212,0.08));color:var(--text);border:1px solid rgba(124,58,237,0.22);box-shadow:0 8px 28px rgba(7,10,20,0.08)}

    /* preview area */
    .preview-wrap{display:flex;flex-direction:column;gap:12px}
    .preview-card{flex:1;min-height:320px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:28px;border-radius:18px;border:1px solid rgba(255,255,255,0.03);box-shadow:0 14px 60px rgba(2,6,23,0.08);display:flex;flex-direction:column;justify-content:center;align-items:stretch;transition:transform var(--ease), box-shadow var(--ease), opacity var(--ease)}
    body[data-theme='light'] .preview-card{background:linear-gradient(180deg, rgba(2,6,23,0.01), rgba(2,6,23,0.01));box-shadow:0 6px 18px rgba(2,6,23,0.04)}

    /* animation when updating font */
    .preview-card.is-updating{opacity:0.45;transform:translateY(8px) scale(0.996)}

    .preview-text{width:100%;min-height:140px;outline:none;border:none;background:transparent;color:inherit;font-size:28px;line-height:1.2;transition:all var(--ease);word-break:break-word}

    .controls-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-top:10px}
    .muted-sm{font-size:12px;color:var(--muted)}

    footer.note{grid-column:1/-1;margin-top:6px;color:var(--muted);font-size:13px}

    .color-preview{width:18px;height:18px;border-radius:50%;border:1px solid rgba(255,255,255,0.12);display:inline-block;margin-left:6px;vertical-align:middle}

    /* small screen (mobile improvements) */
    @media (max-width:600px){
      .app{grid-template-columns:1fr; padding:16px; margin:16px auto; gap:16px;}
      .logo{width:36px; height:36px;}
      .panel{padding:20px; overflow-y:auto; max-height:70vh;} /* Allow scrolling if needed */
      .preview-card{min-height:280px; padding:24px;}
      .preview-text{font-size:24px; line-height:1.4;} /* Better readability */
      .row{flex-direction:column; gap:12px;} /* Stack buttons vertically for easier tapping */
      .btn{padding:12px 16px; font-size:14px;} /* Larger touch targets */
      .range input[type='range']{height:8px;} /* Easier slider interaction */
      .range{margin:8px 0;} /* More space around sliders */
      textarea{min-height:100px;} /* Easier typing */
    }
    @media (max-width:480px){
      .preview-text{font-size:22px;} /* Prevent text from being too small */
      .app{padding:12px;}
      .btn{font-size:16px;} /* Ensure readable button text */
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="logo">FG</div>
      <div>
        <h1>Font Preview — Modern UI</h1>
        <p class="lead">Smooth controls for color, size, spacing, alignment and styling. Choose from the provided fonts.</p>
      </div>

      <div class="header-actions">
        <div id="theme-toggle" class="theme-toggle btn" title="Toggle theme">Toggle theme</div>
      </div>
    </header>

    <!-- LEFT: controls -->
    <aside class="panel">
      <div class="section">
        <label for="font-select">Choose a font</label>
        <select id="font-select"><option value="">-- choose a font --</option></select>
        <div style="height:8px"></div>
        <div class="muted-sm" id="font-hint">Select a font — fonts load from GitHub and fallback to system if they can't be fetched.</div>
      </div>

      <div class="section">
        <label for="text-input">Sample text</label>
        <textarea id="text-input">ضع نصك هنا</textarea>
      </div>

      <div class="section">
        <label>Appearance</label>
        <div class="row">
          <div class="col">
            <label class="muted-sm">Text color <span id="text-color-preview" class="color-preview"></span></label>
            <input id="text-color" type="color" value="#e6eef6" />
          </div>
          <div class="col">
            <label class="muted-sm">Background <span id="bg-color-preview" class="color-preview"></span></label>
            <input id="bg-color" type="color" value="#071024" />
          </div>
        </div>

        <div style="height:10px"></div>
        <div class="range">
          <label class="muted-sm">Size</label>
          <input id="size-range" type="range" min="12" max="160" value="32" />
          <output id="size-out">32px</output>
        </div>

        <div style="height:10px"></div>
        <div class="range">
          <label class="muted-sm">Letter / Word spacing</label>
          <input id="letter-range" type="range" min="-8" max="32" value="0" />
          <output id="letter-out">0px</output>
        </div>

        <div style="height:10px"></div>
        <div class="range">
          <label class="muted-sm">Line height</label>
          <input id="line-range" type="range" min="1" max="3" step="0.05" value="1.2" />
          <output id="line-out">1.20</output>
        </div>
      </div>

      <div class="section">
        <label>Text controls</label>
        <div class="row">
          <button id="align-left" class="btn active" title="Align left">Left</button>
          <button id="align-center" class="btn" title="Align center">Center</button>
          <button id="align-right" class="btn" title="Align right">Right</button>
        </div>
        <div style="height:10px"></div>
        <div class="row">
          <button id="toggle-bold" class="btn" title="Toggle bold">Bold</button>
          <button id="toggle-italic" class="btn" title="Toggle italic">Italic</button>
          <button id="reset" class="btn" title="Reset settings">Reset</button>
        </div>
      </div>

      <div class="section muted-sm">
        <div>Progress: <span id="load-status">Waiting</span></div>
      </div>

    </aside>

    <!-- RIGHT: preview -->
    <main class="preview-wrap">
      <div class="preview-card" id="preview-card">
        <div contenteditable="true" id="preview-text" class="preview-text" spellcheck="false" dir="auto">ضع نصك هنا</div>
      </div>

      <div class="controls-grid panel">
        <div class="muted-sm">Tip: Click the preview to edit it directly.</div>
        <div class="muted-sm">Fonts provided by the site — select any of the 7 fonts.</div>
        <div class="muted-sm">Supports TTF/OTF/WOFF/WOFF2 – remote fonts loaded via fetch.</div>
      </div>

      <footer class="note">Made modern — adjust settings and enjoy the smooth preview.</footer>
    </main>
  </div>

  <script>
    // ---------- Configuration: remote fonts (raw.githubusercontent) ----------
    const remoteFontUrls = [
      'https://raw.githubusercontent.com/fsfs99/font-app/main/fonts/alfont_com_Tasees-Bold.ttf',
      'https://raw.githubusercontent.com/fsfs99/font-app/main/fonts/alfont_com_All-Genders-Regular-v4.otf',
      'https://raw.githubusercontent.com/fsfs99/font-app/main/fonts/alfont_com_AlFont_com_pdms-saleem-quranfont.ttf',
      'https://raw.githubusercontent.com/fsfs99/font-app/main/fonts/alfont_com_AlFont_com_GE-Thuluth-Light_10%20(1).otf',
      'https://raw.githubusercontent.com/fsfs99/font-app/main/fonts/alfont_com_AM_Thulth_Regular_0.1.ttf',
      'https://raw.githubusercontent.com/fsfs99/font-app/main/fonts/Sanabel-Khebrat-Musamem-2021.otf',
      'https://raw.githubusercontent.com/fsfs99/font-app/main/fonts/101-Spirit-Of-Doha-Black-1.otf'
    ];
    const remoteFontNames = [
      'Tasees Bold', 'All Genders Regular v4', 'Pdms Saleem Quranfont', 'GE Thuluth Light 10', 'AM Thulth Regular 0.1', 'Sanabel Khebrat Musamem 2021', 'Spirit Of Doha Black 1'
    ];

    // ---------- DOM refs ----------
    const fontSelect = document.getElementById('font-select');
    const textInput = document.getElementById('text-input');
    const previewText = document.getElementById('preview-text');
    const previewCard = document.getElementById('preview-card');
    const textColor = document.getElementById('text-color');
    const bgColor = document.getElementById('bg-color');
    const sizeRange = document.getElementById('size-range');
    const sizeOut = document.getElementById('size-out');
    const letterRange = document.getElementById('letter-range');
    const letterOut = document.getElementById('letter-out');
    const lineRange = document.getElementById('line-range');
    const lineOut = document.getElementById('line-out');
    const alignLeft = document.getElementById('align-left');
    const alignCenter = document.getElementById('align-center');
    const alignRight = document.getElementById('align-right');
    const toggleBold = document.getElementById('toggle-bold');
    const toggleItalic = document.getElementById('toggle-italic');
    const resetBtn = document.getElementById('reset');
    const loadStatus = document.getElementById('load-status');
    const themeToggle = document.getElementById('theme-toggle');
    const textColorPreview = document.getElementById('text-color-preview');
    const bgColorPreview = document.getElementById('bg-color-preview');

    // loaded fonts registry
    const fonts = {};

    function populateFontSelect(){
      for(let i=0;i<remoteFontUrls.length;i++){
        const opt=document.createElement('option');opt.value=`remote-${i}`;opt.textContent=remoteFontNames[i];fontSelect.appendChild(opt);
      }
      const sysOpt=document.createElement('option');sysOpt.value='system';sysOpt.textContent='System UI (default)';fontSelect.appendChild(sysOpt);
    }
    populateFontSelect();

    // helper: fetch with timeout using AbortController
    async function fetchWithTimeout(url, timeout = 10000){
      const ac = new AbortController();
      const id = setTimeout(()=> ac.abort(), timeout);
      try{
        const resp = await fetch(url, { signal: ac.signal });
        clearTimeout(id);
        return resp;
      }catch(err){
        clearTimeout(id);
        throw err;
      }
    }

    // Load a remote font via fetch -> blob -> FontFace
    async function loadRemoteFont(index){
      const name = `remote-font-${index}`;
      if(fonts[name]) return name; // already loaded
      const url = remoteFontUrls[index];
      updateStatus(`Loading ${remoteFontNames[index]}...`);
      try
